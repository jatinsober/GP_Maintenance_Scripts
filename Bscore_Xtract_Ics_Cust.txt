------
--DEV BY : Jitendra Lodwal  
--DATE  : 26-AUG-2011 
--DESC : FUNCTION
------

SET SEARCH_PATH TO WORKAREA;

CREATE OR REPLACE FUNCTION Bscore_Xtract_Ics_Cust(RUN_DATE IN DATE) RETURNS VOID AS $$
DECLARE 
PROC_DT DATE;
BEGIN

PROC_DT := RUN_DATE;

TRUNCATE TABLE BSCORE_ICS_CUST;

INSERT INTO BSCORE_ICS_CUST(CAR_BUS_CYC_DT,CAR_A_ACCT_NO,CAR_PRIMARY_ID,CAR_REL_TYP_CD,CAR_PRIME_NO)
SELECT CAR_BUS_CYC_DT,CAR_A_ACCT_NO,CAR_PRIMARY_ID,CAR_REL_TYP_CD,CAR_PRIME_NO
FROM CUST_ACCT_REL_HT_BSCORE WHERE  CAR_BUS_CYC_DT  = PROC_DT;
--COMMIT;

END;
$$
LANGUAGE PLPGSQL;


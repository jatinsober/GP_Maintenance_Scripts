------
--DEV BY : Jitendra Lodwal  
--DATE  : 26-AUG-2011 
--DESC : FUNCTION
------

SET SEARCH_PATH TO WORKAREA;

CREATE OR REPLACE FUNCTION BSCORE_XTRACT_ALS_CUST(CYC_DT IN DATE) RETURNS VOID AS $$
BEGIN

	TRUNCATE TABLE BSCORE_ALS_CUST;
	--COMMIT;

	INSERT INTO BSCORE_PROC_LOG(SYS_ID, BUS_CYC_DT, PROCESS_MSG, PROC_DT)
	VALUES ('ALS', CYC_DT, 'START INSERT BSCORE_ALS_CUST', LOCALTIMESTAMP);
	--COMMIT;

	INSERT INTO BSCORE_ALS_CUST(BUS_CYC_DT, ACCT_NO, CUST_ID, REL_TYP_CD, PRIME_NO)
	SELECT CYC_DT, CAR_A_ACCT_NO, CAR_PRIMARY_ID, CAR_REL_TYP_CD, CAR_PRIME_NO
	FROM DWPROD.CUST_ACCT_REL_HT CAR
	WHERE CAR_BUS_CYC_DT = CYC_DT
	AND CAR_A_APPL_SYS_ID = 'ALS';
	--COMMIT;

	INSERT INTO BSCORE_PROC_LOG(SYS_ID, BUS_CYC_DT, PROCESS_MSG, PROC_DT)
	VALUES ('ALS', CYC_DT, 'END INSERT BSCORE_ALS_CUST', LOCALTIMESTAMP);
	--COMMIT;

END;
$$
LANGUAGE PLPGSQL;


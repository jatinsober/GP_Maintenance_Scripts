------
--DEV BY : Jitendra Lodwal  
--DATE  : 25-AUG-2011 
--DESC : FUNCTION
------

SET SEARCH_PATH TO WORKAREA;

CREATE OR REPLACE FUNCTION Mep_Update_Ics() RETURNS VOID AS $$

BEGIN
--ACCT_HT_ICS
TRUNCATE TABLE ACCT_HT_ICS;
--INSERT INTO RESULT
--VALUES('START EXTRACT'||TO_CHAR(LOCALTIMESTAMP, 'DD-MON-YYYY HH:MI:SS'));
INSERT INTO ACCT_HT_ICS
SELECT * FROM dwprod.acct_ht_1_prt_acct_ht_201009
WHERE ACCT_APPL_SYS_ID='ICS';
--COMMIT;
TRUNCATE TABLE ACCT_HT_ICS_PREV;
INSERT INTO ACCT_HT_ICS_PREV (ACCT_BUS_CYC_DT,ACCT_ACCT_ID,ACCT_CUR_BAL)
SELECT ACCT_BUS_CYC_DT,ACCT_ACCT_ID,ACCT_CUR_BAL
FROM dwprod.acct_ht_1_prt_acct_ht_201008
WHERE ACCT_APPL_SYS_ID='ICS';
--COMMIT;
--CONSUMER_INST_LN_HT_ICS
TRUNCATE TABLE CONSUMER_INST_LN_HT_ICS;
INSERT INTO CONSUMER_INST_LN_HT_ICS
SELECT * FROM  dwprod.consumer_inst_ln_ht_1_prt_consumer_inst_ln_ht_201009
WHERE  CI_APPL_SYS_ID = 'ICS';
--COMMIT;

--CONSUMER_INST_LN_HT_ICS_PREV

--CREDIT_PROVISIONS_HT_ICS
--CONSUMER_INST_LN_HT_ICS_PREV
TRUNCATE TABLE CREDIT_PROVISIONS_HT_ICS;
INSERT INTO CREDIT_PROVISIONS_HT_ICS
SELECT *
FROM dwprod.credit_provisions_ht_1_prt_credit_provisions_ht_201009
WHERE IIS_APPL_SYS_ID = 'ICS';
--COMMIT;
TRUNCATE TABLE CREDIT_PROVISIONS_HT_ICS_PREV;
INSERT INTO CREDIT_PROVISIONS_HT_ICS_PREV(IIS_BUS_CYC_DT,IIS_ACCT_ID,IIS_MOS_IN_ARREARS)
SELECT IIS_BUS_CYC_DT,IIS_ACCT_ID,IIS_MOS_IN_ARREARS
FROM dwprod.credit_provisions_ht_1_prt_credit_provisions_ht_201008
WHERE IIS_APPL_SYS_ID = 'ICS';
--COMMIT;
--INSERT INTO RESULT
--VALUES('END EXTRACT'||TO_CHAR(LOCALTIMESTAMP, 'DD-MON-YYYY HH:MI:SS'));
END;
$$
LANGUAGE PLPGSQL;


------
--DEV BY : Jitendra Lodwal  
--DATE  : 26-AUG-2011 
--DESC : FUNCTION
------

SET SEARCH_PATH TO WORKAREA;
CREATE OR REPLACE FUNCTION BSCORE_XTRACT_ALS_COLLAT_FD(CYC_DT IN DATE)  RETURNS VOID AS $$
BEGIN

	TRUNCATE TABLE BSCORE_ALS_COLLAT_FD;
	--COMMIT;

	INSERT INTO BSCORE_ALS_COLLAT_FD(BUS_CYC_DT,ACCT_NO,COLL_NO,TYP_CD,VALUE,MATUR_DT,EFFECT_DT,EXPR_DT,VALUAT_DT)
	SELECT COAR_BUS_CYC_DT,COAR_R_ACCT_NO,COAR_COLL_NO,CFIN_TYP_CD,CFIN_VALUE,CFIN_MATUR_DT,CFIN_EFFECT_DT,CFIN_EXPR_DT,CFIN_VALUAT_DT
    FROM dwprod.collat_acct_rel_ht_1_prt_collat_acct_rel_ht_201102, dwprod.collat_fin_ht_1_prt_collat_fin_ht_201102
    WHERE  COAR_COLL_NO = CFIN_COLL_NO 
	
    AND COAR_R_APPL_SYS_ID ='ALS';
	--COMMIT;
END;

$$
LANGUAGE PLPGSQL;
